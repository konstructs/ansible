#!/bin/bash

> /tmp/update-konstructs.log

log() {
  echo "[$(date)] $@" >> /tmp/update-konstructs.log
  echo "[$(date)] $@"
}

log "Remove server files"
rm -rf binary meta

log "Unpack prod server dump"
tar xf world.tar.xz

log "Remove old server jar"
rm server.jar

log "Download new dev server.jar"
wget -qO server.jar \
	https://bintray.com/artifact/download/konstructs/jars/konstructs-server-build-dev.jar

log "Set owner"
chown -R {{ konstructs_user }} binary meta server.jar

log "All done!"
